# Application configuration
quarkus.http.limits.max-body-size=1M
quarkus.qute.content-types.html=text/html;charset=utf-8


quarkus.http.port=${PORT:8080}
quarkus.http.host=0.0.0.0

quarkus.native.enabled=false
%prod.quarkus.native.enabled=true

# Use container build for cross-platform compatibility
quarkus.native.container-build=true
quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21

# Native image optimizations
quarkus.native.additional-build-args=\
  --initialize-at-build-time=,\
  --enable-url-protocols=http,\
  --enable-url-protocols=https,\
  -H:+ReportExceptionStackTraces,\
  -H:+PrintClassInitialization,\
  -H:+RemoveUnusedSymbols,\
  -H:+UnlockExperimentalVMOptions

# Use fast-jar for faster startup (JVM mode)
quarkus.package.type=fast-jar


quarkus.native.additional-build-args=--enable-preview,-J--enable-preview
quarkus.test.arg-line=--enable-preview
%dev.quarkus.test.arg-line=--enable-preview
%prod.quarkus.args=--enable-preview

# Enable preview features for dev mode live reload
quarkus.live-reload.instrumentation=false
%dev.quarkus.live-reload.instrumentation=false

# Production logging
%prod.quarkus.log.level=INFO
%prod.quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n
%prod.quarkus.log.console.color=false

# Development logging
%dev.quarkus.log.level=INFO
%dev.quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n

quarkus.health.extensions.enabled=true
quarkus.health.openapi.included=true

# These are used by GitHub Actions, not for local builds
# Disabled by default to prevent build errors locally
%prod.quarkus.container-image.build=false
%prod.quarkus.container-image.push=false
%prod.quarkus.container-image.registry=registry.heroku.com
%prod.quarkus.container-image.group=${HEROKU_APP_NAME}
%prod.quarkus.container-image.name=web

# Disable unnecessary features in production
%prod.quarkus.arc.remove-unused-beans=true
%prod.quarkus.arc.unremovable-types=none

# Optimize for startup time
%prod.quarkus.native.enable-all-security-services=false

%dev.quarkus.http.cors=true
%dev.quarkus.http.access-log.enabled=true
